import{m as b,p as we,g as c,o as u,b as e,i as _,a as ke,w as je,f as Ee,d as Se,l as Te,t as s,q as S,F as fe,s as he,k as Ce,v as Be}from"./app-DrQb64Rf.js";const Pe={class:"min-h-screen bg-gradient-to-br from-amber-50 to-amber-100"},$e={class:"bg-medieval-dark text-medieval-gold shadow-lg"},Ae={class:"container mx-auto px-4 py-4"},Ne={class:"flex justify-between items-center"},Oe={class:"flex-1 flex justify-end space-x-4"},qe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2"},Re={class:"bg-white rounded-lg shadow-2xl max-w-6xl w-full h-[95vh] flex flex-col"},Ve={class:"p-4 flex-1 flex flex-col overflow-hidden"},Fe={class:"mb-4"},Xe={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},He={class:"bg-gray-50 rounded-lg p-4"},De={class:"subtitle-medieval text-medieval-gold mb-3 text-center"},Me={class:"flex items-center space-x-4"},Ie={class:"flex-1 space-y-2"},Le={class:"flex justify-between text-xs mb-1"},Ke={class:"text-red-600 font-semibold"},ze={class:"w-full bg-gray-300 rounded-full h-2 shadow-inner"},Ge={class:"flex justify-between text-xs mb-1"},Je={class:"text-blue-600 font-semibold"},We={class:"w-full bg-gray-300 rounded-full h-2 shadow-inner"},Ue={class:"grid grid-cols-2 gap-2 text-xs text-medieval"},Qe={class:"flex justify-between"},Ye={class:"font-semibold text-medieval-gold"},Ze={class:"flex justify-between"},et={class:"font-semibold text-green-600"},tt={class:"bg-red-50 rounded-lg p-4"},st={class:"subtitle-medieval text-medieval-gold mb-3 text-center"},at={class:"flex items-center space-x-4"},lt={class:"flex-shrink-0"},ot=["src","alt"],nt={key:1,class:"w-16 h-16 bg-gray-300 rounded-lg flex items-center justify-center text-2xl"},it={class:"flex-1 space-y-2"},rt={class:"flex justify-between text-xs mb-1"},dt={class:"text-red-600 font-semibold"},ct={class:"w-full bg-gray-300 rounded-full h-2 shadow-inner"},ut={class:"grid grid-cols-2 gap-2 text-xs text-medieval"},vt={class:"flex justify-between"},mt={class:"font-semibold text-medieval-gold"},xt={class:"flex justify-between"},bt={class:"font-semibold text-orange-600"},ft={class:"flex justify-between"},ht={class:"font-semibold text-blue-600"},gt={class:"flex justify-between"},_t={class:"font-semibold text-green-600"},pt={class:"mb-4 flex-1 flex flex-col min-h-0"},yt={class:"bg-gray-900 text-green-400 p-3 rounded-lg flex-1 overflow-y-auto font-mono text-xs battle-log min-h-0"},wt={key:0,class:"text-gray-500"},kt={key:0,class:"border-t border-gray-200 pt-3"},jt={class:"text-center"},Et={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4"},St={key:1,class:"flex items-center justify-center mb-4"},Tt={class:"flex items-center space-x-2 cursor-pointer"},Ct={class:"flex justify-center space-x-4"},Bt=["disabled"],Pt=["disabled"],$t={key:1,class:"border-t border-gray-200 pt-4"},At={class:"text-center"},Nt={class:"text-4xl mb-3"},Ot={class:"text-lg text-medieval mb-4 font-semibold"},qt={key:0,class:"bg-green-50 border border-green-200 p-4 rounded-lg mb-4"},Rt={class:"flex justify-center space-x-6 text-sm"},Vt={class:"text-yellow-600 font-semibold"},Ft={class:"text-blue-600 font-semibold"},Xt={class:"flex-1 p-4"},Ht={class:"max-w-6xl mx-auto"},Dt={class:"card-medieval mb-6"},Mt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},It={class:"text-center"},Lt={class:"font-semibold text-medieval"},Kt={class:"text-sm text-medieval-stone"},zt={class:"text-center"},Gt={class:"font-semibold text-red-600"},Jt={class:"text-center"},Wt={class:"font-semibold text-blue-600"},Ut={class:"card-medieval"},Qt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Yt={class:"mb-2 flex justify-center"},Zt=["src","alt"],es={key:1,class:"text-4xl"},ts={class:"font-semibold text-lg text-medieval text-center mb-2"},ss={class:"text-sm text-medieval-stone text-center mb-3"},as={class:"space-y-1 text-xs text-medieval mb-4"},ls={class:"flex justify-between"},os={class:"font-semibold text-medieval-gold"},ns={class:"flex justify-between"},is={class:"font-semibold text-red-600"},rs={class:"flex justify-between"},ds={class:"font-semibold text-orange-600"},cs={class:"flex justify-between"},us={class:"font-semibold text-blue-600"},vs={class:"flex justify-between"},ms={class:"font-semibold text-green-600"},xs={class:"bg-gray-50 p-2 rounded mb-3"},bs={class:"text-xs text-center space-y-1"},fs={class:"flex justify-between"},hs={class:"font-semibold"},gs={class:"flex justify-between"},_s={class:"font-semibold"},ps={class:"flex justify-between"},ys={class:"font-semibold"},ws=["onClick","disabled"],Es={__name:"Index",props:{character:Object,monsters:Array},setup(a){const j=a,E=b(!1),i=b(null),y=b(null),f=b([]),h=b(!1),x=b(null),v=b(!1),g=b(!1),p=b(null),T=o=>o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(1)+"K":o.toString(),C=async o=>{var t;try{const r=await fetch(route("battle.start"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||"","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({monster_id:o.id})});if(!r.ok){const m=await r.json();if(console.error("Erro ao iniciar batalha:",m),m.error){d(`‚ùå ${m.error}`);return}throw new Error(`HTTP error! status: ${r.status}`)}const l=await r.json();Object.assign(j.character,l.character),i.value=l.monster,y.value=l.battle_instance_id,E.value=!0,f.value=[],h.value=!1,x.value=null,v.value=!1,console.log("Battle setup:",{battle_instance_id:l.battle_instance_id,monster_hp:l.monster.current_hp,is_continuing:l.is_continuing_battle}),l.is_continuing_battle?d(`Continuando batalha contra ${o.name}! (HP: ${l.monster.current_hp}/${l.monster.max_hp})`):d(`Batalha iniciada contra ${o.name}!`)}catch(r){console.error("Erro ao iniciar batalha:",r),d("‚ùå Erro ao iniciar batalha!")}},B=()=>{w(),E.value=!1,i.value=null,y.value=null,f.value=[],h.value=!1,x.value=null,v.value=!1,g.value=!1},ge=async()=>{i.value&&await C(i.value)},d=o=>{f.value.push(`[${new Date().toLocaleTimeString()}] ${o}`),f.value.length>20&&(f.value=f.value.slice(-20)),setTimeout(()=>{const t=document.querySelector(".battle-log");t&&(t.scrollTop=t.scrollHeight)},100)},_e=()=>{g.value?pe():w()},pe=()=>{p.value&&clearInterval(p.value),d("ü§ñ Batalha autom√°tica ativada!"),p.value=setInterval(()=>{var o;!h.value&&!v.value&&(((o=j.character)==null?void 0:o.current_hp)||0)>0?P():h.value&&w()},3e3)},w=()=>{p.value&&(clearInterval(p.value),p.value=null),g.value&&d("‚èπÔ∏è Batalha autom√°tica desativada!")},P=async()=>{var o;if(!(v.value||!i.value)){v.value=!0,d("Voc√™ atacou!");try{console.log("Iniciando ataque...",{monster_id:i.value.id,route:route("battle.attack")});const t=((o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"))||"";console.log("CSRF Token:",t);const r=await fetch(route("battle.attack"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({battle_instance_id:y.value})});if(console.log("Resposta recebida:",r.status,r.statusText),!r.ok){const m=await r.json();if(console.error("Erro na resposta:",m),m.error&&m.error.includes("Stamina insuficiente")){d(`‚ùå ${m.error}`);return}throw new Error(`HTTP error! status: ${r.status} - ${m.error||"Erro desconhecido"}`)}const l=await r.json();console.log("Dados recebidos:",l),Object.assign(j.character,l.character),Object.assign(i.value,l.monster),l.attack_result&&d(l.attack_result.message),l.monster_attack_result&&d(l.monster_attack_result.message),l.battle_over&&(h.value=!0,x.value=l.result,l.result.winner==="character"?d(`üèÜ Vit√≥ria! Ganhou ${l.result.gold_reward} gold e ${l.result.exp_reward} EXP!`):l.result.winner==="monster"?d("üíÄ Derrota! Voc√™ foi derrotado!"):l.result.winner==="fled"&&d("üèÉ Voc√™ fugiu da batalha!"))}catch(t){console.error("Erro ao atacar:",t),d("‚ùå Erro ao executar ataque!")}finally{v.value=!1}}},ye=async()=>{var o;if(!v.value){v.value=!0;try{const t=((o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"))||"";console.log("Fugindo... CSRF Token:",t);const r=await fetch(route("battle.flee"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({battle_instance_id:y.value})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const l=await r.json();h.value=!0,x.value=l.result,d(l.result.message)}catch(t){console.error("Erro ao fugir:",t),d("‚ùå Erro ao tentar fugir!")}finally{v.value=!1}}},$=o=>{o.target.style.display="none";const t=o.target.nextElementSibling;t&&(t.style.display="flex")};return we(()=>{w()}),(o,t)=>{var r,l,m,A,N,O,q,R,V,F,X,H,D,M,I,L,K,z,G,J,W,U,Q,Y,Z,ee,te,se,ae,le,oe,ne,ie,re,de,ce;return u(),c("div",Pe,[e("header",$e,[e("div",Ae,[e("div",Ne,[t[2]||(t[2]=e("div",{class:"flex-1"},[e("h1",{class:"text-2xl font-bold title-medieval"},"Chronicles of Eldoria")],-1)),t[3]||(t[3]=e("div",{class:"flex-1 text-center"},[e("h2",{class:"text-lg font-medieval"},"Arena de Batalha")],-1)),e("div",Oe,[ke(Se(Te),{href:o.route("dashboard"),class:"btn-medieval text-sm px-4 py-2 bg-transparent border-medieval-gold text-medieval-gold hover:bg-medieval-gold hover:text-medieval-dark"},{default:je(()=>[...t[1]||(t[1]=[Ee(" Voltar ao Dashboard ",-1)])]),_:1},8,["href"])])])])]),E.value?(u(),c("div",qe,[e("div",Re,[e("div",{class:"bg-medieval-dark text-medieval-gold p-4 rounded-t-lg"},[e("div",{class:"flex justify-between items-center"},[t[4]||(t[4]=e("h3",{class:"text-xl font-bold title-medieval"},"Combate",-1)),e("button",{onClick:B,class:"text-medieval-gold hover:text-white text-2xl"}," √ó ")])]),e("div",Ve,[e("div",Fe,[e("div",Xe,[e("div",He,[e("h4",De,s((r=a.character)==null?void 0:r.name),1),e("div",Me,[t[9]||(t[9]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-16 h-16 bg-medieval-bronze rounded-lg flex items-center justify-center text-2xl"}," ‚öîÔ∏è ")],-1)),e("div",Ie,[e("div",null,[e("div",Le,[t[5]||(t[5]=e("span",{class:"text-medieval"},"HP:",-1)),e("span",Ke,s((l=a.character)==null?void 0:l.current_hp)+"/"+s((m=a.character)==null?void 0:m.max_hp),1)]),e("div",ze,[e("div",{class:"bg-gradient-to-r from-red-500 to-red-600 h-2 rounded-full transition-all duration-500 ease-out shadow-sm",style:S({width:(A=a.character)!=null&&A.max_hp?`${(((N=a.character)==null?void 0:N.current_hp)||0)/a.character.max_hp*100}%`:"0%"})},null,4)])]),e("div",null,[e("div",Ge,[t[6]||(t[6]=e("span",{class:"text-medieval"},"Stamina:",-1)),e("span",Je,s((O=a.character)==null?void 0:O.current_stamina)+"/"+s((q=a.character)==null?void 0:q.max_stamina),1)]),e("div",We,[e("div",{class:"bg-gradient-to-r from-blue-500 to-blue-600 h-2 rounded-full transition-all duration-500 ease-out shadow-sm",style:S({width:(R=a.character)!=null&&R.max_stamina?`${(((V=a.character)==null?void 0:V.current_stamina)||0)/a.character.max_stamina*100}%`:"0%"})},null,4)])]),e("div",Ue,[e("div",Qe,[t[7]||(t[7]=e("span",null,"N√≠vel:",-1)),e("span",Ye,s((F=a.character)==null?void 0:F.level),1)]),e("div",Ze,[t[8]||(t[8]=e("span",null,"Poder:",-1)),e("span",et,s((X=a.character)==null?void 0:X.power),1)])])])])]),e("div",tt,[e("h4",st,s((H=i.value)==null?void 0:H.name),1),e("div",at,[e("div",lt,[(D=i.value)!=null&&D.image_path?(u(),c("img",{key:0,src:i.value.image_path,alt:i.value.name,class:"w-16 h-16 object-contain",onError:$},null,40,ot)):(u(),c("div",nt,s((M=i.value)==null?void 0:M.image),1))]),e("div",it,[e("div",null,[e("div",rt,[t[10]||(t[10]=e("span",{class:"text-medieval"},"HP:",-1)),e("span",dt,s((I=i.value)==null?void 0:I.current_hp)+"/"+s((L=i.value)==null?void 0:L.max_hp),1)]),e("div",ct,[e("div",{class:"bg-gradient-to-r from-red-500 to-red-600 h-2 rounded-full transition-all duration-500 ease-out shadow-sm",style:S({width:(K=i.value)!=null&&K.max_hp?`${(((z=i.value)==null?void 0:z.current_hp)||0)/i.value.max_hp*100}%`:"0%"})},null,4)])]),e("div",ut,[e("div",vt,[t[11]||(t[11]=e("span",null,"N√≠vel:",-1)),e("span",mt,s((G=i.value)==null?void 0:G.level),1)]),e("div",xt,[t[12]||(t[12]=e("span",null,"Ataque:",-1)),e("span",bt,s((J=i.value)==null?void 0:J.attack_power),1)]),e("div",ft,[t[13]||(t[13]=e("span",null,"Defesa:",-1)),e("span",ht,s((W=i.value)==null?void 0:W.defense),1)]),e("div",gt,[t[14]||(t[14]=e("span",null,"Velocidade:",-1)),e("span",_t,s((U=i.value)==null?void 0:U.speed),1)])])])])])])]),e("div",pt,[t[15]||(t[15]=e("h3",{class:"text-base subtitle-medieval mb-2 text-medieval-gold"},"Log de Combate",-1)),e("div",yt,[(u(!0),c(fe,null,he(f.value,(n,k)=>(u(),c("div",{key:k,class:"mb-1"},s(n),1))),128)),f.value.length===0?(u(),c("div",wt," A batalha come√ßou! Escolha sua a√ß√£o... ")):_("",!0)])]),h.value?_("",!0):(u(),c("div",kt,[e("div",jt,[t[18]||(t[18]=e("h3",{class:"text-base subtitle-medieval mb-3 text-medieval-gold"},"Escolha sua A√ß√£o",-1)),(((Q=a.character)==null?void 0:Q.current_hp)||0)<=0?(u(),c("div",Et,[...t[16]||(t[16]=[e("p",{class:"text-sm text-red-800"}," üíÄ Voc√™ est√° morto! Precisa ser revivido para batalhar. ",-1)])])):_("",!0),(((Y=a.character)==null?void 0:Y.current_hp)||0)>0?(u(),c("div",St,[e("label",Tt,[Ce(e("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=n=>g.value=n),onChange:_e,class:"w-4 h-4 text-medieval-gold bg-gray-100 border-gray-300 rounded focus:ring-medieval-gold focus:ring-2"},null,544),[[Be,g.value]]),t[17]||(t[17]=e("span",{class:"text-sm text-medieval font-medium"},"Batalha Autom√°tica",-1))])])):_("",!0),e("div",Ct,[e("button",{onClick:P,disabled:v.value||(((Z=a.character)==null?void 0:Z.current_hp)||0)<=0||g.value,class:"btn-medieval px-6 py-2 text-base font-semibold disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 transition-transform"},s(v.value?"Atacando...":g.value?"ü§ñ Autom√°tico":"Atacar"),9,Bt),e("button",{onClick:ye,disabled:v.value,class:"btn-medieval px-6 py-2 text-base font-semibold bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 transition-transform"}," Fugir ",8,Pt)])])])),h.value?(u(),c("div",$t,[e("div",At,[e("div",Nt,s(((ee=x.value)==null?void 0:ee.winner)==="character"?"üèÜ":"üíÄ"),1),e("p",Ot,s((te=x.value)==null?void 0:te.message),1),((se=x.value)==null?void 0:se.winner)==="character"?(u(),c("div",qt,[t[19]||(t[19]=e("h4",{class:"font-bold text-green-800 mb-2 text-base"},"Recompensas Obtidas:",-1)),e("div",Rt,[e("span",Vt,"ü™ô +"+s(((ae=x.value)==null?void 0:ae.gold_reward)||0)+" Gold",1),e("span",Ft,"‚≠ê +"+s(((le=x.value)==null?void 0:le.exp_reward)||0)+" EXP",1)])])):_("",!0),e("div",{class:"flex justify-center space-x-4"},[e("button",{onClick:ge,class:"btn-medieval px-6 py-2 text-base font-semibold transform hover:scale-105 transition-transform"}," Batalhar Novamente "),e("button",{onClick:B,class:"btn-medieval px-6 py-2 text-base font-semibold bg-transparent border-medieval-gold text-medieval-gold hover:bg-medieval-gold hover:text-medieval-dark transform hover:scale-105 transition-transform"}," Fechar ")])])])):_("",!0)])])])):_("",!0),e("main",Xt,[e("div",Ht,[e("div",Dt,[t[25]||(t[25]=e("h3",{class:"text-xl subtitle-medieval mb-4 text-medieval-gold"},"Seu Personagem",-1)),e("div",Mt,[e("div",It,[t[20]||(t[20]=e("div",{class:"text-2xl mb-2"},"‚öîÔ∏è",-1)),e("h4",Lt,s((oe=a.character)==null?void 0:oe.name),1),e("p",Kt,"N√≠vel "+s((ne=a.character)==null?void 0:ne.level),1)]),e("div",zt,[t[21]||(t[21]=e("div",{class:"text-2xl mb-2"},"‚ù§Ô∏è",-1)),e("h4",Gt,s((ie=a.character)==null?void 0:ie.current_hp)+"/"+s((re=a.character)==null?void 0:re.max_hp),1),t[22]||(t[22]=e("p",{class:"text-sm text-medieval-stone"},"Pontos de Vida",-1))]),e("div",Jt,[t[23]||(t[23]=e("div",{class:"text-2xl mb-2"},"‚ö°",-1)),e("h4",Wt,s((de=a.character)==null?void 0:de.current_stamina)+"/"+s((ce=a.character)==null?void 0:ce.max_stamina),1),t[24]||(t[24]=e("p",{class:"text-sm text-medieval-stone"},"Pontos de Stamina",-1))])])]),e("div",Ut,[t[34]||(t[34]=e("h3",{class:"text-xl subtitle-medieval mb-4 text-medieval-gold"},"Escolha seu Oponente",-1)),e("div",Qt,[(u(!0),c(fe,null,he(a.monsters,n=>{var k,ue,ve,me,xe,be;return u(),c("div",{key:n.id,class:"bg-white rounded-lg border-2 border-gray-200 p-4 hover:border-medieval-gold transition-colors"},[e("div",Yt,[n.image_path?(u(),c("img",{key:0,src:n.image_path,alt:n.name,class:"w-16 h-16 object-contain",onError:$},null,40,Zt)):(u(),c("div",es,s(n.image),1))]),e("h4",ts,s(n.name),1),e("p",ss,s(n.description),1),e("div",as,[e("div",ls,[t[26]||(t[26]=e("span",null,"N√≠vel:",-1)),e("span",os,s(n.level),1)]),e("div",ns,[t[27]||(t[27]=e("span",null,"HP:",-1)),e("span",is,s(n.max_hp),1)]),e("div",rs,[t[28]||(t[28]=e("span",null,"Ataque:",-1)),e("span",ds,s(n.attack_power),1)]),e("div",cs,[t[29]||(t[29]=e("span",null,"Defesa:",-1)),e("span",us,s(n.defense),1)]),e("div",vs,[t[30]||(t[30]=e("span",null,"Velocidade:",-1)),e("span",ms,s(n.speed),1)])]),e("div",xs,[e("div",bs,[e("div",fs,[t[31]||(t[31]=e("span",{class:"text-yellow-600"},"ü™ô Gold:",-1)),e("span",hs,s(T(n.gold_reward)),1)]),e("div",gs,[t[32]||(t[32]=e("span",{class:"text-blue-600"},"‚≠ê EXP:",-1)),e("span",_s,s(T(n.exp_reward)),1)]),e("div",ps,[t[33]||(t[33]=e("span",{class:"text-purple-600"},"‚ö° Stamina:",-1)),e("span",ys,s(n.stamina_cost||10),1)])])]),e("button",{onClick:ks=>C(n),disabled:n.level>(((k=a.character)==null?void 0:k.level)||0)+2||(((ue=a.character)==null?void 0:ue.current_stamina)||0)<(n.stamina_cost||10)||(((ve=a.character)==null?void 0:ve.current_hp)||0)<=0,class:"w-full btn-medieval text-sm py-2 disabled:opacity-50 disabled:cursor-not-allowed"},s(n.level>(((me=a.character)==null?void 0:me.level)||0)+2?"Muito Forte":(((xe=a.character)==null?void 0:xe.current_hp)||0)<=0?"Morto":(((be=a.character)==null?void 0:be.current_stamina)||0)<(n.stamina_cost||10)?"Sem Stamina":"Batalhar"),9,ws)])}),128))])])])]),t[35]||(t[35]=e("footer",{class:"bg-medieval-dark text-medieval-stone text-center py-4"},[e("p",null,"¬© 2025 Chronicles of Eldoria. Todos os direitos reservados.")],-1))])}}};export{Es as default};
