import{m as we,p as b,q as ke,g as c,o as u,b as e,i as p,a as je,w as Ee,f as Te,d as Se,l as Ae,t as s,s as A,F as fe,x as he,k as Ce,v as Be}from"./app-Iarm9lTk.js";const Pe={class:"min-h-screen bg-gradient-to-br from-amber-50 to-amber-100"},$e={class:"bg-medieval-dark text-medieval-gold shadow-lg"},Ne={class:"container mx-auto px-4 py-4"},Oe={class:"flex justify-between items-center"},Ve={class:"flex-1 flex justify-end space-x-4"},qe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4"},Re={class:"bg-white rounded-lg shadow-2xl max-w-6xl w-full h-[95vh] sm:h-[90vh] flex flex-col"},Xe={class:"p-2 sm:p-4 flex-1 flex flex-col overflow-hidden"},Fe={class:"mb-2 sm:mb-4"},He={class:"grid grid-cols-1 lg:grid-cols-2 gap-2 sm:gap-4"},De={class:"bg-gray-50 rounded-lg p-2 sm:p-4"},Ie={class:"subtitle-medieval text-medieval-gold mb-2 sm:mb-3 text-center text-sm sm:text-base"},Me={class:"flex items-center space-x-2 sm:space-x-4"},Le={class:"flex-1 space-y-1 sm:space-y-2"},Ge={class:"flex justify-between text-xs mb-1"},Ke={class:"text-red-600 font-semibold text-xs"},ze={class:"w-full bg-gray-300 rounded-full h-1.5 sm:h-2 shadow-inner"},Je={class:"flex justify-between text-xs mb-1"},Ue={class:"text-blue-600 font-semibold text-xs"},We={class:"w-full bg-gray-300 rounded-full h-1.5 sm:h-2 shadow-inner"},Qe={class:"grid grid-cols-2 gap-2 text-xs text-medieval"},Ye={class:"flex justify-between"},Ze={class:"font-semibold text-medieval-gold"},et={class:"flex justify-between"},tt={class:"font-semibold text-green-600"},st={class:"bg-red-50 rounded-lg p-2 sm:p-4"},at={class:"subtitle-medieval text-medieval-gold mb-2 sm:mb-3 text-center text-sm sm:text-base"},lt={class:"flex items-center space-x-2 sm:space-x-4"},ot={class:"flex-shrink-0"},nt=["src","alt"],it={key:1,class:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-300 rounded-lg flex items-center justify-center text-lg sm:text-2xl"},rt={class:"flex-1 space-y-1 sm:space-y-2"},dt={class:"flex justify-between text-xs mb-1"},ct={class:"text-red-600 font-semibold text-xs"},ut={class:"w-full bg-gray-300 rounded-full h-1.5 sm:h-2 shadow-inner"},mt={class:"grid grid-cols-2 gap-2 text-xs text-medieval"},vt={class:"flex justify-between"},xt={class:"font-semibold text-medieval-gold"},bt={class:"flex justify-between"},ft={class:"font-semibold text-orange-600"},ht={class:"flex justify-between"},gt={class:"font-semibold text-blue-600"},pt={class:"flex justify-between"},_t={class:"font-semibold text-green-600"},yt={class:"mb-2 sm:mb-4 flex-1 flex flex-col min-h-0"},wt={class:"bg-gray-900 text-green-400 p-2 sm:p-3 rounded-lg flex-1 overflow-y-auto font-mono text-xs battle-log min-h-0"},kt={key:0,class:"text-gray-500"},jt={key:0,class:"border-t border-gray-200 pt-2 sm:pt-3"},Et={class:"text-center"},Tt={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-2 sm:p-3 mb-3 sm:mb-4"},St={key:1,class:"flex items-center justify-center mb-3 sm:mb-4"},At={class:"flex items-center space-x-2 cursor-pointer"},Ct={class:"flex flex-col sm:flex-row justify-center gap-2 sm:gap-4"},Bt=["disabled"],Pt=["disabled"],$t={key:1,class:"border-t border-gray-200 pt-3 sm:pt-4"},Nt={class:"text-center"},Ot={class:"text-base sm:text-lg text-medieval mb-3 sm:mb-4 font-semibold"},Vt={key:0,class:"bg-green-50 border border-green-200 p-2 sm:p-4 rounded-lg mb-3 sm:mb-4"},qt={class:"flex justify-center space-x-4 sm:space-x-6 text-xs sm:text-sm"},Rt={class:"text-yellow-600 font-semibold"},Xt={class:"text-blue-600 font-semibold"},Ft={class:"flex-1 p-4"},Ht={class:"max-w-6xl mx-auto"},Dt={class:"card-medieval mb-6"},It={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Mt={class:"text-center"},Lt={class:"font-semibold text-medieval"},Gt={class:"text-sm text-medieval-stone"},Kt={class:"text-center"},zt={class:"font-semibold text-red-600"},Jt={class:"text-center"},Ut={class:"font-semibold text-blue-600"},Wt={class:"card-medieval"},Qt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Yt={class:"mb-2 flex justify-center"},Zt=["src","alt"],es={key:1,class:"text-4xl"},ts={class:"font-semibold text-lg text-medieval text-center mb-2"},ss={class:"text-sm text-medieval-stone text-center mb-3"},as={class:"space-y-1 text-xs text-medieval mb-4"},ls={class:"flex justify-between"},os={class:"font-semibold text-medieval-gold"},ns={class:"flex justify-between"},is={class:"font-semibold text-red-600"},rs={class:"flex justify-between"},ds={class:"font-semibold text-orange-600"},cs={class:"flex justify-between"},us={class:"font-semibold text-blue-600"},ms={class:"flex justify-between"},vs={class:"font-semibold text-green-600"},xs={class:"bg-gray-50 p-2 rounded mb-3"},bs={class:"text-xs text-center space-y-1"},fs={class:"flex justify-between"},hs={class:"font-semibold"},gs={class:"flex justify-between"},ps={class:"font-semibold"},_s={class:"flex justify-between"},ys={class:"font-semibold"},ws=["onClick","disabled"],Es={__name:"Index",props:{character:Object,monsters:Array},setup(a){const E=a,T=we(),S=b(!1),i=b(null),w=b(null),f=b([]),h=b(!1),g=b(null),v=b(!1),x=b(!1),_=b(null),C=l=>l>=1e6?(l/1e6).toFixed(1)+"M":l>=1e3?(l/1e3).toFixed(1)+"K":l.toString(),B=async l=>{var t;try{const m=T.props.csrf_token||((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||"",o=await fetch(route("battle.start"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":m,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify({monster_id:l.id})});if(!o.ok){const y=await o.json();if(console.error("Erro ao iniciar batalha:",y),y.error){d(`❌ ${y.error}`);return}throw new Error(`HTTP error! status: ${o.status}`)}const r=await o.json();Object.assign(E.character,r.character),i.value=r.monster,w.value=r.battle_instance_id,S.value=!0,f.value=[],h.value=!1,g.value=null,v.value=!1,console.log("Battle setup:",{battle_instance_id:r.battle_instance_id,monster_hp:r.monster.current_hp,is_continuing:r.is_continuing_battle}),r.is_continuing_battle?d(`Continuando batalha contra ${l.name}! (HP: ${r.monster.current_hp}/${r.monster.max_hp})`):d(`Batalha iniciada contra ${l.name}!`)}catch(m){console.error("Erro ao iniciar batalha:",m),d("❌ Erro ao iniciar batalha!")}},P=()=>{k(),S.value=!1,i.value=null,w.value=null,f.value=[],h.value=!1,g.value=null,v.value=!1,x.value=!1},ge=async()=>{i.value&&await B(i.value)},d=l=>{f.value.push(`[${new Date().toLocaleTimeString()}] ${l}`),f.value.length>20&&(f.value=f.value.slice(-20)),setTimeout(()=>{const t=document.querySelector(".battle-log");t&&(t.scrollTop=t.scrollHeight)},100)},pe=()=>{x.value?_e():k()},_e=()=>{_.value&&clearInterval(_.value),d("🤖 Batalha automática ativada!"),_.value=setInterval(()=>{var l;!h.value&&!v.value&&(((l=E.character)==null?void 0:l.current_hp)||0)>0?$():h.value&&k()},3e3)},k=()=>{_.value&&(clearInterval(_.value),_.value=null),x.value&&(d("⏹️ Batalha automática desativada!"),x.value=!1)},$=async()=>{var l;if(!(v.value||!i.value)){v.value=!0,d("Você atacou!");try{const t=T.props.csrf_token||((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||"",m=await fetch(route("battle.attack"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify({battle_instance_id:w.value})});if(!m.ok){const r=await m.json();if(console.error("Erro na resposta:",r),r.error&&r.error.includes("Stamina insuficiente")){d(`❌ ${r.error}`);return}throw new Error(`HTTP error! status: ${m.status} - ${r.error||"Erro desconhecido"}`)}const o=await m.json();console.log("Dados recebidos:",o),Object.assign(E.character,o.character),Object.assign(i.value,o.monster),o.attack_result&&d(o.attack_result.message),o.monster_attack_result&&d(o.monster_attack_result.message),o.battle_over&&(h.value=!0,g.value=o.result,x.value=!1,o.result.winner==="character"?d(`[VITÓRIA] Você derrotou o monstro! Ganhou ${o.result.gold_reward} gold e ${o.result.exp_reward} EXP!`):o.result.winner==="monster"?d("[DERROTA] Você foi derrotado pelo monstro!"):o.result.winner==="fled"&&d("[FUGA] Você fugiu da batalha!"))}catch(t){console.error("Erro ao atacar:",t),d("❌ Erro ao executar ataque!")}finally{v.value=!1}}},ye=async()=>{var l;if(!v.value){v.value=!0;try{const t=T.props.csrf_token||((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||"",m=await fetch(route("battle.flee"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify({battle_instance_id:w.value})});if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const o=await m.json();h.value=!0,g.value=o.result,d(o.result.message)}catch(t){console.error("Erro ao fugir:",t),d("❌ Erro ao tentar fugir!")}finally{v.value=!1}}},N=l=>{l.target.style.display="none";const t=l.target.nextElementSibling;t&&(t.style.display="flex")};return ke(()=>{k()}),(l,t)=>{var m,o,r,y,O,V,q,R,X,F,H,D,I,M,L,G,K,z,J,U,W,Q,Y,Z,ee,te,se,ae,le,oe,ne,ie,re,de,ce;return u(),c("div",Pe,[e("header",$e,[e("div",Ne,[e("div",Oe,[t[2]||(t[2]=e("div",{class:"flex-1"},[e("h1",{class:"text-2xl font-bold title-medieval"},"Chronicles of Eldoria")],-1)),t[3]||(t[3]=e("div",{class:"flex-1 text-center"},[e("h2",{class:"text-lg font-medieval"},"Arena de Batalha")],-1)),e("div",Ve,[je(Se(Ae),{href:l.route("dashboard"),class:"btn-medieval text-sm px-4 py-2 bg-transparent border-medieval-gold text-medieval-gold hover:bg-medieval-gold hover:text-medieval-dark"},{default:Ee(()=>[...t[1]||(t[1]=[Te(" Voltar ao Dashboard ",-1)])]),_:1},8,["href"])])])])]),S.value?(u(),c("div",qe,[e("div",Re,[e("div",{class:"bg-medieval-dark text-medieval-gold p-3 sm:p-4 rounded-t-lg"},[e("div",{class:"flex justify-between items-center"},[t[4]||(t[4]=e("h3",{class:"text-lg sm:text-xl font-bold title-medieval"},"Combate",-1)),e("button",{onClick:P,class:"text-medieval-gold hover:text-white text-xl sm:text-2xl p-1"}," × ")])]),e("div",Xe,[e("div",Fe,[e("div",He,[e("div",De,[e("h4",Ie,s((m=a.character)==null?void 0:m.name),1),e("div",Me,[t[9]||(t[9]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-12 h-12 sm:w-16 sm:h-16 bg-medieval-bronze rounded-lg flex items-center justify-center text-lg sm:text-2xl"}," ⚔️ ")],-1)),e("div",Le,[e("div",null,[e("div",Ge,[t[5]||(t[5]=e("span",{class:"text-medieval"},"HP:",-1)),e("span",Ke,s((o=a.character)==null?void 0:o.current_hp)+"/"+s((r=a.character)==null?void 0:r.max_hp),1)]),e("div",ze,[e("div",{class:"bg-gradient-to-r from-red-500 to-red-600 h-1.5 sm:h-2 rounded-full transition-all duration-500 ease-out shadow-sm",style:A({width:(y=a.character)!=null&&y.max_hp?`${(((O=a.character)==null?void 0:O.current_hp)||0)/a.character.max_hp*100}%`:"0%"})},null,4)])]),e("div",null,[e("div",Je,[t[6]||(t[6]=e("span",{class:"text-medieval"},"Stamina:",-1)),e("span",Ue,s((V=a.character)==null?void 0:V.current_stamina)+"/"+s((q=a.character)==null?void 0:q.max_stamina),1)]),e("div",We,[e("div",{class:"bg-gradient-to-r from-blue-500 to-blue-600 h-1.5 sm:h-2 rounded-full transition-all duration-500 ease-out shadow-sm",style:A({width:(R=a.character)!=null&&R.max_stamina?`${(((X=a.character)==null?void 0:X.current_stamina)||0)/a.character.max_stamina*100}%`:"0%"})},null,4)])]),e("div",Qe,[e("div",Ye,[t[7]||(t[7]=e("span",null,"Nível:",-1)),e("span",Ze,s((F=a.character)==null?void 0:F.level),1)]),e("div",et,[t[8]||(t[8]=e("span",null,"Poder:",-1)),e("span",tt,s((H=a.character)==null?void 0:H.power),1)])])])])]),e("div",st,[e("h4",at,s((D=i.value)==null?void 0:D.name),1),e("div",lt,[e("div",ot,[(I=i.value)!=null&&I.image_path?(u(),c("img",{key:0,src:i.value.image_path,alt:i.value.name,class:"w-12 h-12 sm:w-16 sm:h-16 object-contain",onError:N},null,40,nt)):(u(),c("div",it,s((M=i.value)==null?void 0:M.image),1))]),e("div",rt,[e("div",null,[e("div",dt,[t[10]||(t[10]=e("span",{class:"text-medieval"},"HP:",-1)),e("span",ct,s((L=i.value)==null?void 0:L.current_hp)+"/"+s((G=i.value)==null?void 0:G.max_hp),1)]),e("div",ut,[e("div",{class:"bg-gradient-to-r from-red-500 to-red-600 h-1.5 sm:h-2 rounded-full transition-all duration-500 ease-out shadow-sm",style:A({width:(K=i.value)!=null&&K.max_hp?`${(((z=i.value)==null?void 0:z.current_hp)||0)/i.value.max_hp*100}%`:"0%"})},null,4)])]),e("div",mt,[e("div",vt,[t[11]||(t[11]=e("span",null,"Nível:",-1)),e("span",xt,s((J=i.value)==null?void 0:J.level),1)]),e("div",bt,[t[12]||(t[12]=e("span",null,"Ataque:",-1)),e("span",ft,s((U=i.value)==null?void 0:U.attack_power),1)]),e("div",ht,[t[13]||(t[13]=e("span",null,"Defesa:",-1)),e("span",gt,s((W=i.value)==null?void 0:W.defense),1)]),e("div",pt,[t[14]||(t[14]=e("span",null,"Velocidade:",-1)),e("span",_t,s((Q=i.value)==null?void 0:Q.speed),1)])])])])])])]),e("div",yt,[t[15]||(t[15]=e("h3",{class:"text-sm sm:text-base subtitle-medieval mb-1 sm:mb-2 text-medieval-gold"},"Log de Combate",-1)),e("div",wt,[(u(!0),c(fe,null,he(f.value,(n,j)=>(u(),c("div",{key:j,class:"mb-1 break-words"},s(n),1))),128)),f.value.length===0?(u(),c("div",kt," A batalha começou! Escolha sua ação... ")):p("",!0)])]),h.value?p("",!0):(u(),c("div",jt,[e("div",Et,[t[18]||(t[18]=e("h3",{class:"text-sm sm:text-base subtitle-medieval mb-2 sm:mb-3 text-medieval-gold"},"Escolha sua Ação",-1)),(((Y=a.character)==null?void 0:Y.current_hp)||0)<=0?(u(),c("div",Tt,[...t[16]||(t[16]=[e("p",{class:"text-xs sm:text-sm text-red-800"}," 💀 Você está morto! Precisa ser revivido para batalhar. ",-1)])])):p("",!0),(((Z=a.character)==null?void 0:Z.current_hp)||0)>0?(u(),c("div",St,[e("label",At,[Ce(e("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=n=>x.value=n),onChange:pe,class:"w-4 h-4 text-medieval-gold bg-gray-100 border-gray-300 rounded focus:ring-medieval-gold focus:ring-2"},null,544),[[Be,x.value]]),t[17]||(t[17]=e("span",{class:"text-xs sm:text-sm text-medieval font-medium"},"Batalha Automática",-1))])])):p("",!0),e("div",Ct,[e("button",{onClick:$,disabled:v.value||(((ee=a.character)==null?void 0:ee.current_hp)||0)<=0||x.value,class:"btn-medieval px-4 sm:px-6 py-2 text-sm sm:text-base font-semibold disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 transition-transform"},s(v.value?"Atacando...":x.value?"🤖 Automático":"Atacar"),9,Bt),e("button",{onClick:ye,disabled:v.value,class:"btn-medieval px-4 sm:px-6 py-2 text-sm sm:text-base font-semibold bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 transition-transform"}," Fugir ",8,Pt)])])])),h.value?(u(),c("div",$t,[e("div",Nt,[e("p",Ot,s((te=g.value)==null?void 0:te.message),1),((se=g.value)==null?void 0:se.winner)==="character"?(u(),c("div",Vt,[t[19]||(t[19]=e("h4",{class:"font-bold text-green-800 mb-2 text-sm sm:text-base"},"Recompensas Obtidas:",-1)),e("div",qt,[e("span",Rt,"🪙 +"+s(((ae=g.value)==null?void 0:ae.gold_reward)||0)+" Gold",1),e("span",Xt,"⭐ +"+s(((le=g.value)==null?void 0:le.exp_reward)||0)+" EXP",1)])])):p("",!0),e("div",{class:"flex flex-col sm:flex-row justify-center gap-2 sm:gap-4"},[e("button",{onClick:ge,class:"btn-medieval px-4 sm:px-6 py-2 text-sm sm:text-base font-semibold transform hover:scale-105 transition-transform"}," Batalhar Novamente "),e("button",{onClick:P,class:"btn-medieval px-4 sm:px-6 py-2 text-sm sm:text-base font-semibold bg-transparent border-medieval-gold text-medieval-gold hover:bg-medieval-gold hover:text-medieval-dark transform hover:scale-105 transition-transform"}," Fechar ")])])])):p("",!0)])])])):p("",!0),e("main",Ft,[e("div",Ht,[e("div",Dt,[t[25]||(t[25]=e("h3",{class:"text-xl subtitle-medieval mb-4 text-medieval-gold"},"Seu Personagem",-1)),e("div",It,[e("div",Mt,[t[20]||(t[20]=e("div",{class:"text-2xl mb-2"},"⚔️",-1)),e("h4",Lt,s((oe=a.character)==null?void 0:oe.name),1),e("p",Gt,"Nível "+s((ne=a.character)==null?void 0:ne.level),1)]),e("div",Kt,[t[21]||(t[21]=e("div",{class:"text-2xl mb-2"},"❤️",-1)),e("h4",zt,s((ie=a.character)==null?void 0:ie.current_hp)+"/"+s((re=a.character)==null?void 0:re.max_hp),1),t[22]||(t[22]=e("p",{class:"text-sm text-medieval-stone"},"Pontos de Vida",-1))]),e("div",Jt,[t[23]||(t[23]=e("div",{class:"text-2xl mb-2"},"⚡",-1)),e("h4",Ut,s((de=a.character)==null?void 0:de.current_stamina)+"/"+s((ce=a.character)==null?void 0:ce.max_stamina),1),t[24]||(t[24]=e("p",{class:"text-sm text-medieval-stone"},"Pontos de Stamina",-1))])])]),e("div",Wt,[t[34]||(t[34]=e("h3",{class:"text-xl subtitle-medieval mb-4 text-medieval-gold"},"Escolha seu Oponente",-1)),e("div",Qt,[(u(!0),c(fe,null,he(a.monsters,n=>{var j,ue,me,ve,xe,be;return u(),c("div",{key:n.id,class:"bg-white rounded-lg border-2 border-gray-200 p-4 hover:border-medieval-gold transition-colors"},[e("div",Yt,[n.image_path?(u(),c("img",{key:0,src:n.image_path,alt:n.name,class:"w-16 h-16 object-contain",onError:N},null,40,Zt)):(u(),c("div",es,s(n.image),1))]),e("h4",ts,s(n.name),1),e("p",ss,s(n.description),1),e("div",as,[e("div",ls,[t[26]||(t[26]=e("span",null,"Nível:",-1)),e("span",os,s(n.level),1)]),e("div",ns,[t[27]||(t[27]=e("span",null,"HP:",-1)),e("span",is,s(n.max_hp),1)]),e("div",rs,[t[28]||(t[28]=e("span",null,"Ataque:",-1)),e("span",ds,s(n.attack_power),1)]),e("div",cs,[t[29]||(t[29]=e("span",null,"Defesa:",-1)),e("span",us,s(n.defense),1)]),e("div",ms,[t[30]||(t[30]=e("span",null,"Velocidade:",-1)),e("span",vs,s(n.speed),1)])]),e("div",xs,[e("div",bs,[e("div",fs,[t[31]||(t[31]=e("span",{class:"text-yellow-600"},"🪙 Gold:",-1)),e("span",hs,s(C(n.gold_reward)),1)]),e("div",gs,[t[32]||(t[32]=e("span",{class:"text-blue-600"},"⭐ EXP:",-1)),e("span",ps,s(C(n.exp_reward)),1)]),e("div",_s,[t[33]||(t[33]=e("span",{class:"text-purple-600"},"⚡ Stamina:",-1)),e("span",ys,s(n.stamina_cost||10),1)])])]),e("button",{onClick:ks=>B(n),disabled:n.level>(((j=a.character)==null?void 0:j.level)||0)+2||(((ue=a.character)==null?void 0:ue.current_stamina)||0)<(n.stamina_cost||10)||(((me=a.character)==null?void 0:me.current_hp)||0)<=0,class:"w-full btn-medieval text-sm py-2 disabled:opacity-50 disabled:cursor-not-allowed"},s(n.level>(((ve=a.character)==null?void 0:ve.level)||0)+2?"Muito Forte":(((xe=a.character)==null?void 0:xe.current_hp)||0)<=0?"Morto":(((be=a.character)==null?void 0:be.current_stamina)||0)<(n.stamina_cost||10)?"Sem Stamina":"Batalhar"),9,ws)])}),128))])])])]),t[35]||(t[35]=e("footer",{class:"bg-medieval-dark text-medieval-stone text-center py-4"},[e("p",null,"© 2025 Chronicles of Eldoria. Todos os direitos reservados.")],-1))])}}};export{Es as default};
